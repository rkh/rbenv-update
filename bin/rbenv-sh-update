#!/usr/bin/env bash
set -e
[ -n "$RBENV_DEBUG" ] && set -x

shell="$(basename "${RBENV_SHELL:-$SHELL}")"

case "$shell" in
fish )
  cat <<EOF
command rbenv update $@
if isatty stdout
  echo (set_color --bold)"reloading rbenv"(set_color normal)
  source (rbenv init -|psub)
  echo (set_color --bold)" |  "(set_color normal)"done"
else
  echo "reloading rbenv"
  source (rbenv init -|psub)
  echo " |  done"
end
EOF
  ;;
* )
  cat <<EOF
command rbenv update $@;
if [ -t 1 ]; then
  printf "\\e[1;32mreloading rbenv\\e[0m\\n";
  eval "\$(rbenv init -)";
  printf " \\033[1;32m|\\033[0m  done\\n";
else
  printf "reloading rbenv\\n";
  eval "\$(rbenv init -)";
  printf " |  done\\n";
fi
EOF
  ;;
esac
